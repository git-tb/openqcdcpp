<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>openqcd++: src/specV2.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">openqcd++
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">specV2.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;complex&gt;</code><br />
<code>#include &lt;functional&gt;</code><br />
<code>#include &lt;gsl/gsl_errno.h&gt;</code><br />
<code>#include &lt;gsl/gsl_integration.h&gt;</code><br />
<code>#include &lt;map&gt;</code><br />
<code>#include &lt;boost/math/interpolators/pchip.hpp&gt;</code><br />
<code>#include &lt;boost/program_options.hpp&gt;</code><br />
<code>#include &lt;filesystem&gt;</code><br />
<code>#include &lt;ctime&gt;</code><br />
<code>#include &lt;iomanip&gt;</code><br />
<code>#include &lt;omp.h&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;iterator&gt;</code><br />
<code>#include &quot;<a class="el" href="savedata_8h_source.html">savedata.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="freezeout_8h_source.html">freezeout.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="initdata_8h_source.html">initdata.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="constants_8h_source.html">constants.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="debugmsg_8h_source.html">debugmsg.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for specV2.cpp:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="specV2_8cpp__incl.svg" width="2607" height="344"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="specV2_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structintargs.html">intargs</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">std::function  <a href="structintargs.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac6c1af4e90ab2100f2bea1585ce9cea4" id="r_ac6c1af4e90ab2100f2bea1585ce9cea4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="specV2_8cpp.html#ac6c1af4e90ab2100f2bea1585ce9cea4">omega</a> (double p, double m)</td></tr>
<tr class="separator:ac6c1af4e90ab2100f2bea1585ce9cea4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d045e26f999b0dfac9e4194d1a51a65" id="r_a6d045e26f999b0dfac9e4194d1a51a65"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="specV2_8cpp.html#a6d045e26f999b0dfac9e4194d1a51a65">J0</a> (double x)</td></tr>
<tr class="separator:a6d045e26f999b0dfac9e4194d1a51a65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6361ea05ba43c9613227a5dad0048a3" id="r_ad6361ea05ba43c9613227a5dad0048a3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="specV2_8cpp.html#ad6361ea05ba43c9613227a5dad0048a3">J1</a> (double x)</td></tr>
<tr class="separator:ad6361ea05ba43c9613227a5dad0048a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef533d4e3c1ac64de647736ab0dc57b5" id="r_aef533d4e3c1ac64de647736ab0dc57b5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="specV2_8cpp.html#aef533d4e3c1ac64de647736ab0dc57b5">Y0</a> (double x)</td></tr>
<tr class="separator:aef533d4e3c1ac64de647736ab0dc57b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a407f60e0ae1c91e8c8f71fea265b0894" id="r_a407f60e0ae1c91e8c8f71fea265b0894"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="specV2_8cpp.html#a407f60e0ae1c91e8c8f71fea265b0894">Y1</a> (double x)</td></tr>
<tr class="separator:a407f60e0ae1c91e8c8f71fea265b0894"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a092dd53eb4ec3ed0d3179efe9e304ab8" id="r_a092dd53eb4ec3ed0d3179efe9e304ab8"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::complex&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="specV2_8cpp.html#a092dd53eb4ec3ed0d3179efe9e304ab8">spectr_Jp</a> (std::vector&lt; double &gt; pTs, double m, std::function&lt; std::complex&lt; double &gt;(double)&gt; func, std::function&lt; std::complex&lt; double &gt;(double)&gt; Dfunc, <a class="el" href="structfreezeoutFunctions.html">freezeoutFunctions</a> fo, double epsabs, double epsrel, int iterations, bool anti=false, std::function&lt; void(double, std::complex&lt; double &gt;)&gt; callback=[](double p, std::complex&lt; double &gt; val){ return;})</td></tr>
<tr class="separator:a092dd53eb4ec3ed0d3179efe9e304ab8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adacbe0175a79dff748855d8c9839f82b" id="r_adacbe0175a79dff748855d8c9839f82b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="specV2_8cpp.html#adacbe0175a79dff748855d8c9839f82b">main</a> (int ac, char *av[])</td></tr>
<tr class="separator:adacbe0175a79dff748855d8c9839f82b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7d0baf4850f6b50bc46cff66b6f12ead" id="r_a7d0baf4850f6b50bc46cff66b6f12ead"><td class="memItemLeft" align="right" valign="top">std::complex&lt; double &gt;(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="specV2_8cpp.html#a7d0baf4850f6b50bc46cff66b6f12ead">myintegrand</a> )(double, void *)</td></tr>
<tr class="separator:a7d0baf4850f6b50bc46cff66b6f12ead"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6d045e26f999b0dfac9e4194d1a51a65" name="a6d045e26f999b0dfac9e4194d1a51a65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d045e26f999b0dfac9e4194d1a51a65">&#9670;&#160;</a></span>J0()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double J0 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>double <a class="el" href="specV2_8cpp.html#a6d045e26f999b0dfac9e4194d1a51a65">J0(double x)</a> { return std::cyl_bessel_j(0, x); } /// THESE SEEM TO BE UNOPTIMIZED FOR INTEGER ORDER AND ARE SLOWER BY A FACTOR OF ~10 COMPARED TO THE ALTERNATIVE j0,j1,y0,y1 double <a class="el" href="specV2_8cpp.html#ad6361ea05ba43c9613227a5dad0048a3">J1(double x)</a> { return std::cyl_bessel_j(1, x); } double <a class="el" href="specV2_8cpp.html#aef533d4e3c1ac64de647736ab0dc57b5">Y0(double x)</a> { return std::cyl_neumann(0, x); } double <a class="el" href="specV2_8cpp.html#a407f60e0ae1c91e8c8f71fea265b0894">Y1(double x)</a> { return std::cyl_neumann(1, x); } </p>

<p class="definition">Definition at line <a class="el" href="specV2_8cpp_source.html#l00054">54</a> of file <a class="el" href="specV2_8cpp_source.html">specV2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   54</span>{ <span class="keywordflow">return</span> j0(x); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad6361ea05ba43c9613227a5dad0048a3" name="ad6361ea05ba43c9613227a5dad0048a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6361ea05ba43c9613227a5dad0048a3">&#9670;&#160;</a></span>J1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double J1 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="specV2_8cpp_source.html#l00055">55</a> of file <a class="el" href="specV2_8cpp_source.html">specV2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   55</span>{ <span class="keywordflow">return</span> j1(x); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="adacbe0175a79dff748855d8c9839f82b" name="adacbe0175a79dff748855d8c9839f82b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adacbe0175a79dff748855d8c9839f82b">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>av</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>SET UP DEFAULT DIRECTORY NAME TO SAVE TO</p>
<p>DECLARE SUPPORTED COMMAND LINE OPTIONS</p>
<p>PROCESS CMDLINE OPTIONS</p>
<p>CREATE DIRECTORY TO SAVE FILES</p>
<p>DEFINE CONDENSATE FIELD AND DERIVATIVE ON FREEZOUT SURFACE</p>
<p>SAVE INTERPOLATED FUNCTIONS SAMPLED AT SOME PRESCRIBED RESOLUTION</p>
<p>ONLY IF ONE WANTS TO ENSURE THAT DATA PROCESSING HAS WORKED PROPERLY, THE GEOMETRY DATA IS ALSO SAVED</p>
<p>WRITE TO FILE DURING COMPUTATION, THEREFORE PREPARE THE FILE HERE</p>
<p>COMPUTE SPECTRUM</p>
<p>======================================= START WITH THE PARTICLE SPECTRUM</p>
<p>IF THE SPECTRUM COMPUTATION WOULD HAPPEN IN A SERIAL WAY, IT WOULD BE USEFUL TO INTRODUCE A CALLBACK FUNCTION THAT SAVES THE DATAPOINTS (p[i],spec(p[i])) DIRECTLY AFTER THE iTH STEP, SUCH THAT THE PROGRAM CAN BE INTERRUPTED (OR CRASH) AT ANY POINT AND NOT ALL DATA IS LOST. IF WE COMPUTE THE VALUES (p[i],spec(p[i])) IN PARALLEL, THE RESULTING DATASET WOULD BE WRITTEN TO FILE IN RANDOM ORDER. INSTEAD, WRITE TO AN ORDERED LIST IN THE PARALLEL PROCEDURE AND WRITE TO FILE AFTER ALL VALUES ARE COMPUTED. DATA IS LOST WHEN THE PROGRAM CRASHES IN BETWEEN, BUT THE COMPUTATION IS MUCH FASTER ANYWAYS, SO WE DONT CARE.</p>
<p>CENTRAL COMPUTATION (PARTICLE SPECTRUM) HAPPENS HERE THIS COMPUTES J(p). THE SPECTRUM IS GIVEN BY (1/2)*(1/(2PI)^3)*|J(p)|^2.</p>
<p>======================================= ...AND THEN THE ANTI PARTICLE SPECTRUM</p>
<p>... (((SAME COMMENT ABOUT SERIAL AND PARALLEL EXECUTION...))) ...</p>
<p>CENTRAL COMPUTATION (ANTIPARTICLE SPECTRUM) HAPPENS HERE THIS COMPUTES J(-p). THE SPECTRUM IS GIVEN BY (1/2)*(1/(2PI)^3)*|J(-p)|^2.</p>
<p>:)</p>

<p class="definition">Definition at line <a class="el" href="specV2_8cpp_source.html#l00190">190</a> of file <a class="el" href="specV2_8cpp_source.html">specV2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  191</span>{</div>
<div class="line"><span class="lineno">  193</span>    std::time_t t = std::time(<span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno">  194</span>    std::tm tm = *std::localtime(&amp;t);</div>
<div class="line"><span class="lineno">  195</span>    std::stringstream timestamp_sstr;</div>
<div class="line"><span class="lineno">  196</span>    timestamp_sstr &lt;&lt; std::put_time(&amp;tm, <span class="stringliteral">&quot;%Y%m%d_%H%M%S&quot;</span>);</div>
<div class="line"><span class="lineno">  197</span>    std::string timestamp = timestamp_sstr.str();</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  200</span>    <span class="keyword">namespace </span>po = boost::program_options;</div>
<div class="line"><span class="lineno">  201</span>    po::options_description desc(   <span class="stringliteral">&quot;//================================================================= \\\\\n&quot;</span></div>
<div class="line"><span class="lineno">  202</span>                                    <span class="stringliteral">&quot;|| This program computes the pT-spectrum of particles associated    ||\n&quot;</span></div>
<div class="line"><span class="lineno">  203</span>                                    <span class="stringliteral">&quot;|| to a condensate field during a heavy-ion collision. The field    ||\n&quot;</span></div>
<div class="line"><span class="lineno">  204</span>                                    <span class="stringliteral">&quot;|| is sourced by some unkown Bjorken-(tau,r)-dependent interaction, ||\n&quot;</span></div>
<div class="line"><span class="lineno">  205</span>                                    <span class="stringliteral">&quot;|| but is supposed to be known on the freezeout surface in the      ||\n&quot;</span></div>
<div class="line"><span class="lineno">  206</span>                                    <span class="stringliteral">&quot;|| context of a hydrodynamic evolution of the QGP.                  ||\n&quot;</span></div>
<div class="line"><span class="lineno">  207</span>                                    <span class="stringliteral">&quot;\\\\ ================================================================ //\n\n&quot;</span></div>
<div class="line"><span class="lineno">  208</span>                                    <span class="stringliteral">&quot;Allowed options&quot;</span>);</div>
<div class="line"><span class="lineno">  209</span>    desc.add_options()</div>
<div class="line"><span class="lineno">  210</span>        (<span class="stringliteral">&quot;help&quot;</span>, <span class="stringliteral">&quot;produce help message&quot;</span>)</div>
<div class="line"><span class="lineno">  211</span>        (<span class="stringliteral">&quot;initpath&quot;</span>,        po::value&lt;std::string&gt;(),                   <span class="stringliteral">&quot;csv file containing initial field data&quot;</span>)</div>
<div class="line"><span class="lineno">  212</span>        (<span class="stringliteral">&quot;freezeoutpath&quot;</span>,   po::value&lt;std::string&gt;()-&gt;default_value(<span class="stringliteral">&quot;./../../Mathematica/data/ExampleFreezeOutCorrected.csv&quot;</span>),</div>
<div class="line"><span class="lineno">  213</span>            <span class="stringliteral">&quot;csv file containing freezeout geometry&quot;</span>)</div>
<div class="line"><span class="lineno">  214</span>        (<span class="stringliteral">&quot;m&quot;</span>,               po::value&lt;double&gt;()-&gt;default_value(0.14),   <span class="stringliteral">&quot;particle mass (in GeV)&quot;</span>)</div>
<div class="line"><span class="lineno">  215</span>        (<span class="stringliteral">&quot;pTmax&quot;</span>,           po::value&lt;double&gt;()-&gt;default_value(1.0),    <span class="stringliteral">&quot;spectrum is computed on [0,pTmax] (in GeV)&quot;</span>)</div>
<div class="line"><span class="lineno">  216</span>        (<span class="stringliteral">&quot;NpT&quot;</span>,             po::value&lt;int&gt;()-&gt;default_value(100),       <span class="stringliteral">&quot;number of sample points within [0,pTmax] (in GeV)&quot;</span>)</div>
<div class="line"><span class="lineno">  217</span>        (<span class="stringliteral">&quot;epsabs&quot;</span>,          po::value&lt;double&gt;()-&gt;default_value(0),      <span class="stringliteral">&quot;absolute integration error goal&quot;</span>)</div>
<div class="line"><span class="lineno">  218</span>        (<span class="stringliteral">&quot;epsrel&quot;</span>,          po::value&lt;double&gt;()-&gt;default_value(1e-3),   <span class="stringliteral">&quot;relative integration error goal&quot;</span>)</div>
<div class="line"><span class="lineno">  219</span>        (<span class="stringliteral">&quot;iter&quot;</span>,            po::value&lt;int&gt;()-&gt;default_value(1e4),       <span class="stringliteral">&quot;maximum integration iterations&quot;</span>)</div>
<div class="line"><span class="lineno">  220</span>        (<span class="stringliteral">&quot;parentdir&quot;</span>,       po::value&lt;std::string&gt;()-&gt;default_value(<span class="stringliteral">&quot;Data&quot;</span>),</div>
<div class="line"><span class="lineno">  221</span>            <span class="stringliteral">&quot;data folder, in which a subfolder for the results is created&quot;</span>)</div>
<div class="line"><span class="lineno">  222</span>        (<span class="stringliteral">&quot;foldername&quot;</span>,      po::value&lt;std::string&gt;()-&gt;default_value(<span class="stringliteral">&quot;spec_&quot;</span>+timestamp),</div>
<div class="line"><span class="lineno">  223</span>            <span class="stringliteral">&quot;target folder for this computation. default is a timestamp &#39;spec_YYmmdd_HHMMSS&#39;, this might be insufficient &quot;</span></div>
<div class="line"><span class="lineno">  224</span>            <span class="stringliteral">&quot;if files are created within a second&quot;</span>)</div>
<div class="line"><span class="lineno">  225</span>        (<span class="stringliteral">&quot;savegeometry&quot;</span>,    po::bool_switch()-&gt;default_value(<span class="keyword">false</span>),    <span class="stringliteral">&quot;flag only for debugging, save the freezeout geometry&quot;</span>);</div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>    po::variables_map vm;</div>
<div class="line"><span class="lineno">  228</span>    po::store(po::parse_command_line(ac, av, desc), vm);</div>
<div class="line"><span class="lineno">  229</span>    po::notify(vm);</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  232</span>    <span class="keywordflow">if</span> (vm.count(<span class="stringliteral">&quot;help&quot;</span>))    {</div>
<div class="line"><span class="lineno">  233</span>        std::cout &lt;&lt; desc &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno">  234</span><span class="preprocessor">        #ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  235</span>        <a class="code hl_define" href="debugmsg_8h.html#a287288536f92a3ca9be3d5233db2d243">DEBUGMSG</a>(<span class="stringliteral">&quot;Parallelization with OPENMP enabled.&quot;</span>);</div>
<div class="line"><span class="lineno">  236</span><span class="preprocessor">        #else</span></div>
<div class="line"><span class="lineno">  237</span>        <a class="code hl_define" href="debugmsg_8h.html#a287288536f92a3ca9be3d5233db2d243">DEBUGMSG</a>(<span class="stringliteral">&quot;Parallelization with OPENMP disabled.&quot;</span>);</div>
<div class="line"><span class="lineno">  238</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno">  239</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  240</span>    }</div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span>    <a class="code hl_define" href="debugmsg_8h.html#a287288536f92a3ca9be3d5233db2d243">DEBUGMSG</a>(<span class="stringliteral">&quot;start command line processing&quot;</span>);</div>
<div class="line"><span class="lineno">  243</span>    <span class="keywordtype">double</span>  pTmin               = 0,</div>
<div class="line"><span class="lineno">  244</span>            pTmax               = vm[<span class="stringliteral">&quot;pTmax&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;(),</div>
<div class="line"><span class="lineno">  245</span>            mParticle           = vm[<span class="stringliteral">&quot;m&quot;</span>].as&lt;double&gt;(),</div>
<div class="line"><span class="lineno">  246</span>            epsabs              = vm[<span class="stringliteral">&quot;epsabs&quot;</span>].as&lt;<span class="keywordtype">double</span>&gt;(),</div>
<div class="line"><span class="lineno">  247</span>            epsrel              = vm[<span class="stringliteral">&quot;epsrel&quot;</span>].as&lt;double&gt;();</div>
<div class="line"><span class="lineno">  248</span>    <span class="keywordtype">int</span> NpT                     = vm[<span class="stringliteral">&quot;NpT&quot;</span>].as&lt;<span class="keywordtype">int</span>&gt;(),</div>
<div class="line"><span class="lineno">  249</span>        iter                    = vm[<span class="stringliteral">&quot;iter&quot;</span>].as&lt;int&gt;();</div>
<div class="line"><span class="lineno">  250</span>    std::string initpath        = vm[<span class="stringliteral">&quot;initpath&quot;</span>].as&lt;std::string&gt;(),</div>
<div class="line"><span class="lineno">  251</span>                freezeoutpath   = vm[<span class="stringliteral">&quot;freezeoutpath&quot;</span>].as&lt;std::string&gt;(),</div>
<div class="line"><span class="lineno">  252</span>                parentdir       = vm[<span class="stringliteral">&quot;parentdir&quot;</span>].as&lt;std::string&gt;(),</div>
<div class="line"><span class="lineno">  253</span>                foldername      = vm[<span class="stringliteral">&quot;foldername&quot;</span>].as&lt;std::string&gt;();</div>
<div class="line"><span class="lineno">  254</span>    <span class="keywordtype">bool</span> savegeometry           = vm[<span class="stringliteral">&quot;savegeometry&quot;</span>].as&lt;<span class="keywordtype">bool</span>&gt;();</div>
<div class="line"><span class="lineno">  255</span>    <a class="code hl_define" href="debugmsg_8h.html#a287288536f92a3ca9be3d5233db2d243">DEBUGMSG</a>(<span class="stringliteral">&quot;command line processing completed&quot;</span>);</div>
<div class="line"><span class="lineno">  256</span> </div>
<div class="line"><span class="lineno">  257</span>    <a class="code hl_define" href="debugmsg_8h.html#a287288536f92a3ca9be3d5233db2d243">DEBUGMSG</a>(<span class="stringliteral">&quot;start data processing&quot;</span>);</div>
<div class="line"><span class="lineno">  258</span>    <a class="code hl_struct" href="structfreezeoutData.html">freezeoutData</a> foDat = <a class="code hl_function" href="freezeout_8h.html#a648ff02ea415c6d21a9d67f18b760748">ProcessFreezeoutData</a>(freezeoutpath);</div>
<div class="line"><span class="lineno">  259</span>    <a class="code hl_struct" href="structinitData.html">initData</a> initDat    = <a class="code hl_function" href="initdata_8h.html#adb67cc27cb6accb49529dfa82de80b86">ProcessInitialData</a>(initpath);</div>
<div class="line"><span class="lineno">  260</span>    <a class="code hl_define" href="debugmsg_8h.html#a287288536f92a3ca9be3d5233db2d243">DEBUGMSG</a>(<span class="stringliteral">&quot;data processing completed&quot;</span>);</div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  263</span>    std::string pathname = parentdir+<span class="stringliteral">&quot;/&quot;</span>+foldername;</div>
<div class="line"><span class="lineno">  264</span>    std::filesystem::create_directories(pathname);</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  267</span>    std::function&lt;std::complex&lt;double&gt;(<span class="keywordtype">double</span>)&gt; func = [&amp;initDat](<span class="keywordtype">double</span> alpha)</div>
<div class="line"><span class="lineno">  268</span>    { <span class="keywordflow">return</span> initDat.<a class="code hl_variable" href="structinitData.html#a10b165a0c598cf983de5d2d5b4495fa2">initFunc</a>.<a class="code hl_variable" href="structinitFunctions.html#a4e5ed89ce69b93c3f5f04988d115a593">f0Re</a>(alpha) + 1i * initDat.<a class="code hl_variable" href="structinitData.html#a10b165a0c598cf983de5d2d5b4495fa2">initFunc</a>.<a class="code hl_variable" href="structinitFunctions.html#a04d6ee6922f74093dc3e2e0c970a27c9">f0Im</a>(alpha); };</div>
<div class="line"><span class="lineno">  269</span>    std::function&lt;std::complex&lt;double&gt;(<span class="keywordtype">double</span>)&gt; Dfunc = [&amp;initDat](<span class="keywordtype">double</span> alpha)</div>
<div class="line"><span class="lineno">  270</span>    { <span class="keywordflow">return</span> initDat.<a class="code hl_variable" href="structinitData.html#a10b165a0c598cf983de5d2d5b4495fa2">initFunc</a>.<a class="code hl_variable" href="structinitFunctions.html#a7e45e341bc296cd1894e58bf978b424c">Df0Re</a>(alpha) + 1i * initDat.<a class="code hl_variable" href="structinitData.html#a10b165a0c598cf983de5d2d5b4495fa2">initFunc</a>.<a class="code hl_variable" href="structinitFunctions.html#adcbea9775ed2efb4041c940799bdfc1e">Df0Im</a>(alpha); };</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  273</span>    <span class="keywordtype">int</span> NSAMPLE = 1000;</div>
<div class="line"><span class="lineno">  274</span>    writeFunctionsToFile&lt;std::complex&lt;double&gt;&gt;(     pathname+<span class="stringliteral">&quot;/initialfields.txt&quot;</span>,</div>
<div class="line"><span class="lineno">  275</span>                                                    {func, Dfunc},</div>
<div class="line"><span class="lineno">  276</span>                                                    0, M_PI / 2.0, NSAMPLE,</div>
<div class="line"><span class="lineno">  277</span>                                                    {<span class="stringliteral">&quot;alpha&quot;</span>,<span class="stringliteral">&quot;phi&quot;</span>,<span class="stringliteral">&quot;Dphi&quot;</span>},</div>
<div class="line"><span class="lineno">  278</span>                                                    {timestamp}</div>
<div class="line"><span class="lineno">  279</span>                        );</div>
<div class="line"><span class="lineno">  280</span>    <span class="keywordflow">if</span>(savegeometry) { </div>
<div class="line"><span class="lineno">  283</span>        writeFunctionsToFile&lt;double&gt;(   pathname+<span class="stringliteral">&quot;/geometry.txt&quot;</span>,</div>
<div class="line"><span class="lineno">  284</span>                                        {foDat.<a class="code hl_variable" href="structfreezeoutData.html#a1ed093e995b35b1116ee09a6e4bcca6e">foFunc</a>.<a class="code hl_variable" href="structfreezeoutFunctions.html#a32c184e841ff5b7fe2b2f1b3a46a3f87">tau</a>, foDat.<a class="code hl_variable" href="structfreezeoutData.html#a1ed093e995b35b1116ee09a6e4bcca6e">foFunc</a>.<a class="code hl_variable" href="structfreezeoutFunctions.html#a180e1ed9fb6c6e7bef81db72a73caefa">r</a>, foDat.<a class="code hl_variable" href="structfreezeoutData.html#a1ed093e995b35b1116ee09a6e4bcca6e">foFunc</a>.<a class="code hl_variable" href="structfreezeoutFunctions.html#a668240e0c9454b18953319d7938de8d8">Dtau</a>, foDat.<a class="code hl_variable" href="structfreezeoutData.html#a1ed093e995b35b1116ee09a6e4bcca6e">foFunc</a>.<a class="code hl_variable" href="structfreezeoutFunctions.html#a4e2f2e564792d110beec73fa6ac39580">Dr</a>},</div>
<div class="line"><span class="lineno">  285</span>                                        0, M_PI / 2.0, NSAMPLE,</div>
<div class="line"><span class="lineno">  286</span>                                        {<span class="stringliteral">&quot;alpha&quot;</span>,<span class="stringliteral">&quot;tau&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>,<span class="stringliteral">&quot;Dtau&quot;</span>,<span class="stringliteral">&quot;Dr&quot;</span>},</div>
<div class="line"><span class="lineno">  287</span>                                        {timestamp}</div>
<div class="line"><span class="lineno">  288</span>                            );</div>
<div class="line"><span class="lineno">  289</span>    }  </div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  292</span>    std::stringstream initdata_ss, geometry_ss, NpT_ss, pTmax_ss, epsabs_ss, epsrel_ss, iter_ss, mass_ss;</div>
<div class="line"><span class="lineno">  293</span>    initdata_ss &lt;&lt; <span class="stringliteral">&quot;initdata:\t&quot;</span>        &lt;&lt; initpath;</div>
<div class="line"><span class="lineno">  294</span>    geometry_ss &lt;&lt; <span class="stringliteral">&quot;freezeout file: \t&quot;</span> &lt;&lt; freezeoutpath;</div>
<div class="line"><span class="lineno">  295</span>    NpT_ss      &lt;&lt; <span class="stringliteral">&quot;NpT:\t&quot;</span>             &lt;&lt; NpT;</div>
<div class="line"><span class="lineno">  296</span>    pTmax_ss    &lt;&lt; <span class="stringliteral">&quot;pTmax:\t&quot;</span>           &lt;&lt; pTmax;</div>
<div class="line"><span class="lineno">  297</span>    epsabs_ss   &lt;&lt; <span class="stringliteral">&quot;epsabs:\t&quot;</span>          &lt;&lt; epsabs;</div>
<div class="line"><span class="lineno">  298</span>    epsrel_ss   &lt;&lt; <span class="stringliteral">&quot;epsrel:\t&quot;</span>          &lt;&lt; epsrel;</div>
<div class="line"><span class="lineno">  299</span>    iter_ss     &lt;&lt; <span class="stringliteral">&quot;integr iter:\t&quot;</span>     &lt;&lt; iter;</div>
<div class="line"><span class="lineno">  300</span>    mass_ss     &lt;&lt; <span class="stringliteral">&quot;particle mass:\t&quot;</span>   &lt;&lt; mParticle;</div>
<div class="line"><span class="lineno">  301</span>    std::vector&lt;std::string&gt; comments({   </div>
<div class="line"><span class="lineno">  302</span>        timestamp,</div>
<div class="line"><span class="lineno">  303</span>        initdata_ss.str(),</div>
<div class="line"><span class="lineno">  304</span>        geometry_ss.str(),</div>
<div class="line"><span class="lineno">  305</span>        mass_ss.str(),</div>
<div class="line"><span class="lineno">  306</span>        NpT_ss.str(),</div>
<div class="line"><span class="lineno">  307</span>        pTmax_ss.str(),</div>
<div class="line"><span class="lineno">  308</span>        epsabs_ss.str(),</div>
<div class="line"><span class="lineno">  309</span>        epsrel_ss.str(),</div>
<div class="line"><span class="lineno">  310</span>        iter_ss.str()</div>
<div class="line"><span class="lineno">  311</span>    });</div>
<div class="line"><span class="lineno">  312</span>    std::vector&lt;std::string&gt; headers({<span class="stringliteral">&quot;pT&quot;</span>,<span class="stringliteral">&quot;spec&quot;</span>});</div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  315</span>    std::vector&lt;double&gt; pTs(NpT);</div>
<div class="line"><span class="lineno">  316</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pTs.size(); i++)</div>
<div class="line"><span class="lineno">  317</span>        pTs[i] = pTmin + i * (pTmax - pTmin) / (NpT - 1);</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  321</span>    std::string spectr_path = pathname+<span class="stringliteral">&quot;/spectr.txt&quot;</span>;</div>
<div class="line"><span class="lineno">  322</span>    std::ofstream spectr_output(spectr_path);</div>
<div class="line"><span class="lineno">  323</span>    <span class="keywordflow">if</span> (!spectr_output.is_open()) { std::cerr &lt;&lt; <span class="stringliteral">&quot;Error opening the file: &quot;</span> &lt;&lt; spectr_path &lt;&lt; <span class="stringliteral">&quot; to save to&quot;</span> &lt;&lt; std::endl; <span class="keywordflow">return</span> -1; }</div>
<div class="line"><span class="lineno">  324</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; comments.size(); i++) {</div>
<div class="line"><span class="lineno">  325</span>        spectr_output &lt;&lt; <span class="stringliteral">&quot;# &quot;</span> &lt;&lt; comments[i] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  326</span>    }</div>
<div class="line"><span class="lineno">  327</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; headers.size(); i++) {</div>
<div class="line"><span class="lineno">  328</span>        spectr_output &lt;&lt; headers[i]; </div>
<div class="line"><span class="lineno">  329</span>        <span class="keywordflow">if</span>(i != headers.size()-1) spectr_output &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;</div>
<div class="line"><span class="lineno">  330</span>    }</div>
<div class="line"><span class="lineno">  331</span>    spectr_output &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  340</span>    std::function&lt;void(<span class="keywordtype">double</span>,std::complex&lt;double&gt;)&gt; spectr_callback = [&amp;spectr_output](<span class="keywordtype">double</span> p, std::complex&lt;double&gt; value) {</div>
<div class="line"><span class="lineno">  341</span><span class="preprocessor">        #if not defined(_OPENMP)</span></div>
<div class="line"><span class="lineno">  342</span>        <span class="keywordtype">double</span> abs2norm = 0.5 * (1 / std::pow(2 * M_PI, 3)) * std::norm(value);</div>
<div class="line"><span class="lineno">  343</span>        spectr_output &lt;&lt; p &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; std::real(abs2norm) &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  344</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno">  345</span>    };   </div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  349</span>    std::vector&lt;std::complex&lt;double&gt;&gt; myspectr = <a class="code hl_function" href="specV2_8cpp.html#a092dd53eb4ec3ed0d3179efe9e304ab8">spectr_Jp</a>( pTs,</div>
<div class="line"><span class="lineno">  350</span>                                                            mParticle,</div>
<div class="line"><span class="lineno">  351</span>                                                            func,</div>
<div class="line"><span class="lineno">  352</span>                                                            Dfunc,</div>
<div class="line"><span class="lineno">  353</span>                                                            foDat.<a class="code hl_variable" href="structfreezeoutData.html#a1ed093e995b35b1116ee09a6e4bcca6e">foFunc</a>,</div>
<div class="line"><span class="lineno">  354</span>                                                            epsabs,</div>
<div class="line"><span class="lineno">  355</span>                                                            epsrel,</div>
<div class="line"><span class="lineno">  356</span>                                                            iter,</div>
<div class="line"><span class="lineno">  357</span>                                                            <span class="comment">/*anti=*/</span><span class="keyword">false</span>,</div>
<div class="line"><span class="lineno">  358</span>                                                            spectr_callback);</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span><span class="preprocessor">    #ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  361</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pTs.size(); i++) {</div>
<div class="line"><span class="lineno">  362</span>        <span class="keywordtype">double</span> abs2norm = 0.5 * (1 / std::pow(2 * M_PI, 3)) * std::norm(myspectr[i]);</div>
<div class="line"><span class="lineno">  363</span>        spectr_output &lt;&lt; pTs[i] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; std::real(abs2norm) &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  364</span>    }    </div>
<div class="line"><span class="lineno">  365</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  366</span>    spectr_output.close();</div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  370</span>    std::string spectranti_path = pathname+<span class="stringliteral">&quot;/spectr_anti.txt&quot;</span>;</div>
<div class="line"><span class="lineno">  371</span>    std::ofstream spectranti_output(spectranti_path);</div>
<div class="line"><span class="lineno">  372</span>    <span class="keywordflow">if</span> (!spectranti_output.is_open()) { std::cerr &lt;&lt; <span class="stringliteral">&quot;Error opening the file: &quot;</span> &lt;&lt; spectranti_path &lt;&lt; <span class="stringliteral">&quot; to save to&quot;</span> &lt;&lt; std::endl; <span class="keywordflow">return</span> -1; }</div>
<div class="line"><span class="lineno">  373</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; comments.size(); i++) {</div>
<div class="line"><span class="lineno">  374</span>        spectranti_output &lt;&lt; <span class="stringliteral">&quot;# &quot;</span> &lt;&lt; comments[i] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  375</span>    }</div>
<div class="line"><span class="lineno">  376</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; headers.size(); i++) {</div>
<div class="line"><span class="lineno">  377</span>        spectranti_output &lt;&lt; headers[i];</div>
<div class="line"><span class="lineno">  378</span>        <span class="keywordflow">if</span>(i != headers.size()-1) spectranti_output &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;</div>
<div class="line"><span class="lineno">  379</span>    }</div>
<div class="line"><span class="lineno">  380</span>    spectranti_output &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  385</span>    std::function&lt;void(<span class="keywordtype">double</span>,std::complex&lt;double&gt;)&gt; spectranti_callback = [&amp;spectranti_output](<span class="keywordtype">double</span> p, std::complex&lt;double&gt; value) {</div>
<div class="line"><span class="lineno">  386</span><span class="preprocessor">        #if not defined(_OPENMP)</span></div>
<div class="line"><span class="lineno">  387</span>        <span class="keywordtype">double</span> abs2norm = 0.5 * (1 / std::pow(2 * M_PI, 3)) * std::norm(value);</div>
<div class="line"><span class="lineno">  388</span>        spectranti_output &lt;&lt; p &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; std::real(abs2norm) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; std::imag(abs2norm) &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  389</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno">  390</span>    };</div>
<div class="line"><span class="lineno">  391</span> </div>
<div class="line"><span class="lineno">  394</span>    std::vector&lt;std::complex&lt;double&gt;&gt; myspectr_anti = <a class="code hl_function" href="specV2_8cpp.html#a092dd53eb4ec3ed0d3179efe9e304ab8">spectr_Jp</a>(pTs,</div>
<div class="line"><span class="lineno">  395</span>                                                                mParticle,</div>
<div class="line"><span class="lineno">  396</span>                                                                func,</div>
<div class="line"><span class="lineno">  397</span>                                                                Dfunc,</div>
<div class="line"><span class="lineno">  398</span>                                                                foDat.<a class="code hl_variable" href="structfreezeoutData.html#a1ed093e995b35b1116ee09a6e4bcca6e">foFunc</a>,</div>
<div class="line"><span class="lineno">  399</span>                                                                epsabs,</div>
<div class="line"><span class="lineno">  400</span>                                                                epsrel,</div>
<div class="line"><span class="lineno">  401</span>                                                                iter,</div>
<div class="line"><span class="lineno">  402</span>                                                                <span class="comment">/*anti=*/</span><span class="keyword">true</span>,</div>
<div class="line"><span class="lineno">  403</span>                                                                spectranti_callback);</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span><span class="preprocessor">    #ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  406</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pTs.size(); i++)</div>
<div class="line"><span class="lineno">  407</span>    {</div>
<div class="line"><span class="lineno">  408</span>        <span class="keywordtype">double</span> abs2norm = 0.5 * (1 / std::pow(2 * M_PI, 3)) * std::norm(myspectr_anti[i]);</div>
<div class="line"><span class="lineno">  409</span>        spectranti_output &lt;&lt; pTs[i] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; std::real(abs2norm) &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  410</span>    }</div>
<div class="line"><span class="lineno">  411</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  412</span>    spectranti_output.close();</div>
<div class="line"><span class="lineno">  413</span> </div>
<div class="line"><span class="lineno">  414</span>    <span class="keywordflow">return</span> 0; </div>
<div class="line"><span class="lineno">  415</span>}</div>
<div class="ttc" id="adebugmsg_8h_html_a287288536f92a3ca9be3d5233db2d243"><div class="ttname"><a href="debugmsg_8h.html#a287288536f92a3ca9be3d5233db2d243">DEBUGMSG</a></div><div class="ttdeci">#define DEBUGMSG(str)</div><div class="ttdef"><b>Definition</b> <a href="debugmsg_8h_source.html#l00006">debugmsg.h:6</a></div></div>
<div class="ttc" id="afreezeout_8h_html_a648ff02ea415c6d21a9d67f18b760748"><div class="ttname"><a href="freezeout_8h.html#a648ff02ea415c6d21a9d67f18b760748">ProcessFreezeoutData</a></div><div class="ttdeci">freezeoutData ProcessFreezeoutData(std::string datafile=&quot;NO_FREEZEOUTDATA_SPECIFIED&quot;)</div><div class="ttdef"><b>Definition</b> <a href="freezeout_8h_source.html#l00026">freezeout.h:26</a></div></div>
<div class="ttc" id="ainitdata_8h_html_adb67cc27cb6accb49529dfa82de80b86"><div class="ttname"><a href="initdata_8h.html#adb67cc27cb6accb49529dfa82de80b86">ProcessInitialData</a></div><div class="ttdeci">initData ProcessInitialData(std::string datafile=&quot;NO_INITIALDATA_SPECIFIED&quot;)</div><div class="ttdef"><b>Definition</b> <a href="initdata_8h_source.html#l00028">initdata.h:28</a></div></div>
<div class="ttc" id="aspecV2_8cpp_html_a092dd53eb4ec3ed0d3179efe9e304ab8"><div class="ttname"><a href="specV2_8cpp.html#a092dd53eb4ec3ed0d3179efe9e304ab8">spectr_Jp</a></div><div class="ttdeci">std::vector&lt; std::complex&lt; double &gt; &gt; spectr_Jp(std::vector&lt; double &gt; pTs, double m, std::function&lt; std::complex&lt; double &gt;(double)&gt; func, std::function&lt; std::complex&lt; double &gt;(double)&gt; Dfunc, freezeoutFunctions fo, double epsabs, double epsrel, int iterations, bool anti=false, std::function&lt; void(double, std::complex&lt; double &gt;)&gt; callback=[](double p, std::complex&lt; double &gt; val){ return;})</div><div class="ttdef"><b>Definition</b> <a href="specV2_8cpp_source.html#l00117">specV2.cpp:117</a></div></div>
<div class="ttc" id="astructfreezeoutData_html"><div class="ttname"><a href="structfreezeoutData.html">freezeoutData</a></div><div class="ttdef"><b>Definition</b> <a href="freezeout_8h_source.html#l00021">freezeout.h:21</a></div></div>
<div class="ttc" id="astructfreezeoutData_html_a1ed093e995b35b1116ee09a6e4bcca6e"><div class="ttname"><a href="structfreezeoutData.html#a1ed093e995b35b1116ee09a6e4bcca6e">freezeoutData::foFunc</a></div><div class="ttdeci">freezeoutFunctions foFunc</div><div class="ttdef"><b>Definition</b> <a href="freezeout_8h_source.html#l00023">freezeout.h:23</a></div></div>
<div class="ttc" id="astructfreezeoutFunctions_html_a180e1ed9fb6c6e7bef81db72a73caefa"><div class="ttname"><a href="structfreezeoutFunctions.html#a180e1ed9fb6c6e7bef81db72a73caefa">freezeoutFunctions::r</a></div><div class="ttdeci">std::function&lt; double(double)&gt; r</div><div class="ttdef"><b>Definition</b> <a href="freezeout_8h_source.html#l00016">freezeout.h:16</a></div></div>
<div class="ttc" id="astructfreezeoutFunctions_html_a32c184e841ff5b7fe2b2f1b3a46a3f87"><div class="ttname"><a href="structfreezeoutFunctions.html#a32c184e841ff5b7fe2b2f1b3a46a3f87">freezeoutFunctions::tau</a></div><div class="ttdeci">std::function&lt; double(double)&gt; tau</div><div class="ttdef"><b>Definition</b> <a href="freezeout_8h_source.html#l00015">freezeout.h:15</a></div></div>
<div class="ttc" id="astructfreezeoutFunctions_html_a4e2f2e564792d110beec73fa6ac39580"><div class="ttname"><a href="structfreezeoutFunctions.html#a4e2f2e564792d110beec73fa6ac39580">freezeoutFunctions::Dr</a></div><div class="ttdeci">std::function&lt; double(double)&gt; Dr</div><div class="ttdef"><b>Definition</b> <a href="freezeout_8h_source.html#l00018">freezeout.h:18</a></div></div>
<div class="ttc" id="astructfreezeoutFunctions_html_a668240e0c9454b18953319d7938de8d8"><div class="ttname"><a href="structfreezeoutFunctions.html#a668240e0c9454b18953319d7938de8d8">freezeoutFunctions::Dtau</a></div><div class="ttdeci">std::function&lt; double(double)&gt; Dtau</div><div class="ttdef"><b>Definition</b> <a href="freezeout_8h_source.html#l00017">freezeout.h:17</a></div></div>
<div class="ttc" id="astructinitData_html"><div class="ttname"><a href="structinitData.html">initData</a></div><div class="ttdef"><b>Definition</b> <a href="initdata_8h_source.html#l00023">initdata.h:23</a></div></div>
<div class="ttc" id="astructinitData_html_a10b165a0c598cf983de5d2d5b4495fa2"><div class="ttname"><a href="structinitData.html#a10b165a0c598cf983de5d2d5b4495fa2">initData::initFunc</a></div><div class="ttdeci">initFunctions initFunc</div><div class="ttdef"><b>Definition</b> <a href="initdata_8h_source.html#l00025">initdata.h:25</a></div></div>
<div class="ttc" id="astructinitFunctions_html_a04d6ee6922f74093dc3e2e0c970a27c9"><div class="ttname"><a href="structinitFunctions.html#a04d6ee6922f74093dc3e2e0c970a27c9">initFunctions::f0Im</a></div><div class="ttdeci">std::function&lt; double(double)&gt; f0Im</div><div class="ttdef"><b>Definition</b> <a href="initdata_8h_source.html#l00018">initdata.h:18</a></div></div>
<div class="ttc" id="astructinitFunctions_html_a4e5ed89ce69b93c3f5f04988d115a593"><div class="ttname"><a href="structinitFunctions.html#a4e5ed89ce69b93c3f5f04988d115a593">initFunctions::f0Re</a></div><div class="ttdeci">std::function&lt; double(double)&gt; f0Re</div><div class="ttdef"><b>Definition</b> <a href="initdata_8h_source.html#l00017">initdata.h:17</a></div></div>
<div class="ttc" id="astructinitFunctions_html_a7e45e341bc296cd1894e58bf978b424c"><div class="ttname"><a href="structinitFunctions.html#a7e45e341bc296cd1894e58bf978b424c">initFunctions::Df0Re</a></div><div class="ttdeci">std::function&lt; double(double)&gt; Df0Re</div><div class="ttdef"><b>Definition</b> <a href="initdata_8h_source.html#l00019">initdata.h:19</a></div></div>
<div class="ttc" id="astructinitFunctions_html_adcbea9775ed2efb4041c940799bdfc1e"><div class="ttname"><a href="structinitFunctions.html#adcbea9775ed2efb4041c940799bdfc1e">initFunctions::Df0Im</a></div><div class="ttdeci">std::function&lt; double(double)&gt; Df0Im</div><div class="ttdef"><b>Definition</b> <a href="initdata_8h_source.html#l00020">initdata.h:20</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="specV2_8cpp_adacbe0175a79dff748855d8c9839f82b_cgraph.svg" width="463" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac6c1af4e90ab2100f2bea1585ce9cea4" name="ac6c1af4e90ab2100f2bea1585ce9cea4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6c1af4e90ab2100f2bea1585ce9cea4">&#9670;&#160;</a></span>omega()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double omega </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="specV2_8cpp_source.html#l00049">49</a> of file <a class="el" href="specV2_8cpp_source.html">specV2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   49</span>{ <span class="keywordflow">return</span> sqrt(p * p + m * m); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a092dd53eb4ec3ed0d3179efe9e304ab8" name="a092dd53eb4ec3ed0d3179efe9e304ab8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a092dd53eb4ec3ed0d3179efe9e304ab8">&#9670;&#160;</a></span>spectr_Jp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::complex&lt; double &gt; &gt; spectr_Jp </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt;&#160;</td>
          <td class="paramname"><em>pTs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; std::complex&lt; double &gt;(double)&gt;&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; std::complex&lt; double &gt;(double)&gt;&#160;</td>
          <td class="paramname"><em>Dfunc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structfreezeoutFunctions.html">freezeoutFunctions</a>&#160;</td>
          <td class="paramname"><em>fo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epsabs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epsrel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iterations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>anti</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; void(double, std::complex&lt; double &gt;)&gt;&#160;</td>
          <td class="paramname"><em>callback</em> = <code>[](double&#160;p,&#160;std::complex&lt;double&gt;&#160;val){&#160;return;&#160;}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>61 point Gauss-Kronrod rule <a href="https://www.gnu.org/software/gsl/doc/html/integration.html">https://www.gnu.org/software/gsl/doc/html/integration.html</a></p>
<p>IF EXECUTED IN PARALLEL, EACH THREAD CREATES ITS OWN WORKSPACE IF EXECUTED IN SERIES, SAVE TIME BY REUSING THE WORKSPACE</p>
<p>IN PARALLEL PROCEDURE, THIS HAS NO EFFECT</p>

<p class="definition">Definition at line <a class="el" href="specV2_8cpp_source.html#l00117">117</a> of file <a class="el" href="specV2_8cpp_source.html">specV2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  127</span>                                                                                                 { <span class="keywordflow">return</span>; })</div>
<div class="line"><span class="lineno">  128</span>{</div>
<div class="line"><span class="lineno">  129</span>    std::vector&lt;std::complex&lt;double&gt;&gt; result(pTs.size());</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordtype">int</span> key(6); </div>
<div class="line"><span class="lineno">  132</span>    gsl_set_error_handler_off();</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  136</span><span class="preprocessor">    #if not defined(_OPENMP)</span></div>
<div class="line"><span class="lineno">  137</span>    gsl_integration_workspace *workspace = gsl_integration_workspace_alloc(iterations);</div>
<div class="line"><span class="lineno">  138</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>    <span class="keywordtype">int</span> totalexecuted(0);</div>
<div class="line"><span class="lineno">  141</span><span class="preprocessor">    #pragma omp parallel for default(none) shared(totalexecuted, callback, fo, m, result, anti, std::cout, pTs, func, Dfunc, myintegrand, epsabs, epsrel, iterations, key)</span></div>
<div class="line"><span class="lineno">  142</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pTs.size(); i++)</div>
<div class="line"><span class="lineno">  143</span>    {</div>
<div class="line"><span class="lineno">  144</span><span class="preprocessor">        #pragma omp critical</span></div>
<div class="line"><span class="lineno">  145</span>        std::cout &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; / &quot;</span> &lt;&lt; pTs.size() &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; 100 * (double)totalexecuted/(<span class="keywordtype">double</span>)pTs.size() &lt;&lt; <span class="stringliteral">&quot;%)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  146</span>        totalexecuted++;</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span><span class="preprocessor">        #if defined(_OPENMP)</span></div>
<div class="line"><span class="lineno">  149</span>        gsl_integration_workspace *workspace = gsl_integration_workspace_alloc(iterations);</div>
<div class="line"><span class="lineno">  150</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>        <span class="keywordtype">double</span> pT = pTs[i];</div>
<div class="line"><span class="lineno">  153</span>        <a class="code hl_struct" href="structintargs.html">intargs</a> myargs(pT, m, func, Dfunc, fo, anti);</div>
<div class="line"><span class="lineno">  154</span>        gsl_function F_re, F_im;</div>
<div class="line"><span class="lineno">  155</span>        F_re.function = [](<span class="keywordtype">double</span> alpha, <span class="keywordtype">void</span>* params){ <span class="keywordflow">return</span> std::real(<a class="code hl_variable" href="specV2_8cpp.html#a7d0baf4850f6b50bc46cff66b6f12ead">myintegrand</a>(alpha, params)); };</div>
<div class="line"><span class="lineno">  156</span>        F_im.function = [](<span class="keywordtype">double</span> alpha, <span class="keywordtype">void</span>* params){ <span class="keywordflow">return</span> std::imag(<a class="code hl_variable" href="specV2_8cpp.html#a7d0baf4850f6b50bc46cff66b6f12ead">myintegrand</a>(alpha, params)); };</div>
<div class="line"><span class="lineno">  157</span>        F_re.params = &amp;myargs;</div>
<div class="line"><span class="lineno">  158</span>        F_im.params = &amp;myargs;</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>        <span class="keywordtype">double</span> result_re, result_im, error_re, error_im;</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>        <span class="keywordtype">int</span> status = gsl_integration_qag(&amp;F_re, 0, M_PI_2, epsabs, epsrel, iterations, key, workspace, &amp;result_re, &amp;error_re);</div>
<div class="line"><span class="lineno">  163</span>        <span class="keywordflow">if</span> (status)</div>
<div class="line"><span class="lineno">  164</span><span class="preprocessor">            #pragma omp critical</span></div>
<div class="line"><span class="lineno">  165</span>            <a class="code hl_define" href="debugmsg_8h.html#a287288536f92a3ca9be3d5233db2d243">DEBUGMSG</a>(gsl_strerror(status) &lt;&lt; <span class="stringliteral">&quot; at p = &quot;</span> &lt;&lt; myargs.pT &lt;&lt; <span class="stringliteral">&quot; | estimated error (re): &quot;</span> &lt;&lt; error_re);</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>        status = gsl_integration_qag(&amp;F_im, 0, M_PI_2, epsabs, epsrel, iterations, key, workspace, &amp;result_im, &amp;error_im);</div>
<div class="line"><span class="lineno">  168</span>        <span class="keywordflow">if</span> (status)</div>
<div class="line"><span class="lineno">  169</span><span class="preprocessor">            #pragma omp critical</span></div>
<div class="line"><span class="lineno">  170</span>            <a class="code hl_define" href="debugmsg_8h.html#a287288536f92a3ca9be3d5233db2d243">DEBUGMSG</a>(gsl_strerror(status) &lt;&lt; <span class="stringliteral">&quot; at p = &quot;</span> &lt;&lt; myargs.pT &lt;&lt; <span class="stringliteral">&quot; | estimated error (imag): &quot;</span> &lt;&lt; error_im);</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>        result[i] = result_re + 1i * result_im;</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  175</span>        callback(pTs[i],result[i]);</div>
<div class="line"><span class="lineno">  176</span>    </div>
<div class="line"><span class="lineno">  177</span><span class="preprocessor">        #if defined(_OPENMP)</span></div>
<div class="line"><span class="lineno">  178</span>        gsl_integration_workspace_free(workspace);</div>
<div class="line"><span class="lineno">  179</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno">  180</span>    }</div>
<div class="line"><span class="lineno">  181</span>    </div>
<div class="line"><span class="lineno">  182</span><span class="preprocessor">    #if not defined(_OPENMP)</span></div>
<div class="line"><span class="lineno">  183</span>    gsl_integration_workspace_free(workspace);</div>
<div class="line"><span class="lineno">  184</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  187</span>}</div>
<div class="ttc" id="aspecV2_8cpp_html_a7d0baf4850f6b50bc46cff66b6f12ead"><div class="ttname"><a href="specV2_8cpp.html#a7d0baf4850f6b50bc46cff66b6f12ead">myintegrand</a></div><div class="ttdeci">std::complex&lt; double &gt;(* myintegrand)(double, void *)</div><div class="ttdef"><b>Definition</b> <a href="specV2_8cpp_source.html#l00057">specV2.cpp:61</a></div></div>
<div class="ttc" id="astructintargs_html"><div class="ttname"><a href="structintargs.html">intargs</a></div><div class="ttdoc">std::function</div><div class="ttdef"><b>Definition</b> <a href="integrate_8h_source.html#l00016">integrate.h:16</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="specV2_8cpp_a092dd53eb4ec3ed0d3179efe9e304ab8_icgraph.svg" width="195" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aef533d4e3c1ac64de647736ab0dc57b5" name="aef533d4e3c1ac64de647736ab0dc57b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef533d4e3c1ac64de647736ab0dc57b5">&#9670;&#160;</a></span>Y0()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Y0 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="specV2_8cpp_source.html#l00056">56</a> of file <a class="el" href="specV2_8cpp_source.html">specV2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   56</span>{ <span class="keywordflow">return</span> y0(x); }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a407f60e0ae1c91e8c8f71fea265b0894" name="a407f60e0ae1c91e8c8f71fea265b0894"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a407f60e0ae1c91e8c8f71fea265b0894">&#9670;&#160;</a></span>Y1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Y1 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="specV2_8cpp_source.html#l00057">57</a> of file <a class="el" href="specV2_8cpp_source.html">specV2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   57</span>{ <span class="keywordflow">return</span> y1(x); }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a7d0baf4850f6b50bc46cff66b6f12ead" name="a7d0baf4850f6b50bc46cff66b6f12ead"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d0baf4850f6b50bc46cff66b6f12ead">&#9670;&#160;</a></span>myintegrand</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::complex&lt; double &gt;(* myintegrand) (double, void *) </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= [](<span class="keywordtype">double</span> alpha, <span class="keywordtype">void</span>* params) {</div>
<div class="line">    </div>
<div class="line"> </div>
<div class="line">     </div>
<div class="line">    </div>
<div class="line"> </div>
<div class="line">    </div>
<div class="line"> </div>
<div class="line">    </div>
<div class="line">    <a class="code hl_struct" href="structintargs.html">intargs</a>* args = (<span class="keyword">struct </span><a class="code hl_struct" href="structintargs.html">intargs</a> *)params;</div>
<div class="line">    <span class="keywordtype">double</span>  <a class="code hl_variable" href="structintargs.html#a5dd0c6581c940d24a7eb203d60227b4e">m</a>(args-&gt;<a class="code hl_variable" href="structintargs.html#a5dd0c6581c940d24a7eb203d60227b4e">m</a>),</div>
<div class="line">            <a class="code hl_variable" href="structintargs.html#a31c032a36442c1d116a36f9add7a3496">pT</a>(args-&gt;<a class="code hl_variable" href="structintargs.html#a31c032a36442c1d116a36f9add7a3496">pT</a>),</div>
<div class="line">            wT(<a class="code hl_function" href="specV2_8cpp.html#ac6c1af4e90ab2100f2bea1585ce9cea4">omega</a>(<a class="code hl_variable" href="structintargs.html#a31c032a36442c1d116a36f9add7a3496">pT</a>,<a class="code hl_variable" href="structintargs.html#a5dd0c6581c940d24a7eb203d60227b4e">m</a>)),</div>
<div class="line">            r(args-&gt;<a class="code hl_variable" href="structintargs.html#aaa2e3b3d6fda0ea260ad50ed52b211d3">fo</a>.<a class="code hl_variable" href="structfreezeoutFunctions.html#a180e1ed9fb6c6e7bef81db72a73caefa">r</a>(alpha)       * <a class="code hl_variable" href="______constants_8h.html#a973b252ed356de5f20e5f775d9ec8934">fmtoIGeV</a>),</div>
<div class="line">            Dr(args-&gt;<a class="code hl_variable" href="structintargs.html#aaa2e3b3d6fda0ea260ad50ed52b211d3">fo</a>.<a class="code hl_variable" href="structfreezeoutFunctions.html#a4e2f2e564792d110beec73fa6ac39580">Dr</a>(alpha)     * <a class="code hl_variable" href="______constants_8h.html#a973b252ed356de5f20e5f775d9ec8934">fmtoIGeV</a>),</div>
<div class="line">            tau(args-&gt;<a class="code hl_variable" href="structintargs.html#aaa2e3b3d6fda0ea260ad50ed52b211d3">fo</a>.<a class="code hl_variable" href="structfreezeoutFunctions.html#a32c184e841ff5b7fe2b2f1b3a46a3f87">tau</a>(alpha)   * <a class="code hl_variable" href="______constants_8h.html#a973b252ed356de5f20e5f775d9ec8934">fmtoIGeV</a>),</div>
<div class="line">            Dtau(args-&gt;<a class="code hl_variable" href="structintargs.html#aaa2e3b3d6fda0ea260ad50ed52b211d3">fo</a>.<a class="code hl_variable" href="structfreezeoutFunctions.html#a668240e0c9454b18953319d7938de8d8">Dtau</a>(alpha) * <a class="code hl_variable" href="______constants_8h.html#a973b252ed356de5f20e5f775d9ec8934">fmtoIGeV</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> pm = (args-&gt;<a class="code hl_variable" href="structintargs.html#aea96ae3027750fab9318a81dcc771a85">anti</a> ? -1.0 : +1.0);</div>
<div class="line">    <span class="keywordflow">return</span> 2 * M_PI * M_PI * r * tau * (</div>
<div class="line">        args-&gt;<a class="code hl_variable" href="structintargs.html#a2368dd52091ad0d687dfb7543210682b">Dfunc</a>(alpha) * (</div>
<div class="line">                        <a class="code hl_function" href="specV2_8cpp.html#a6d045e26f999b0dfac9e4194d1a51a65">J0</a>(r*<a class="code hl_variable" href="structintargs.html#a31c032a36442c1d116a36f9add7a3496">pT</a>) * ( -<a class="code hl_function" href="specV2_8cpp.html#aef533d4e3c1ac64de647736ab0dc57b5">Y0</a>(tau*wT) + pm * 1i * <a class="code hl_function" href="specV2_8cpp.html#a6d045e26f999b0dfac9e4194d1a51a65">J0</a>(tau*wT))</div>
<div class="line">        ) +</div>
<div class="line">        args-&gt;<a class="code hl_variable" href="structintargs.html#aaecb7be22f5935a4074513a630896685">func</a>(alpha) * (</div>
<div class="line">            Dtau*<a class="code hl_variable" href="structintargs.html#a31c032a36442c1d116a36f9add7a3496">pT</a> *   <a class="code hl_function" href="specV2_8cpp.html#ad6361ea05ba43c9613227a5dad0048a3">J1</a>(r*<a class="code hl_variable" href="structintargs.html#a31c032a36442c1d116a36f9add7a3496">pT</a>) * ( -<a class="code hl_function" href="specV2_8cpp.html#aef533d4e3c1ac64de647736ab0dc57b5">Y0</a>(tau*wT) + pm * 1i * <a class="code hl_function" href="specV2_8cpp.html#a6d045e26f999b0dfac9e4194d1a51a65">J0</a>(tau*wT)) +</div>
<div class="line">            Dr*wT *     <a class="code hl_function" href="specV2_8cpp.html#a6d045e26f999b0dfac9e4194d1a51a65">J0</a>(r*<a class="code hl_variable" href="structintargs.html#a31c032a36442c1d116a36f9add7a3496">pT</a>) * ( -<a class="code hl_function" href="specV2_8cpp.html#a407f60e0ae1c91e8c8f71fea265b0894">Y1</a>(tau*wT) + pm * 1i * <a class="code hl_function" href="specV2_8cpp.html#ad6361ea05ba43c9613227a5dad0048a3">J1</a>(tau*wT))</div>
<div class="line">        )</div>
<div class="line">    );</div>
<div class="line">}</div>
<div class="ttc" id="a______constants_8h_html_a973b252ed356de5f20e5f775d9ec8934"><div class="ttname"><a href="______constants_8h.html#a973b252ed356de5f20e5f775d9ec8934">fmtoIGeV</a></div><div class="ttdeci">const double fmtoIGeV</div><div class="ttdef"><b>Definition</b> <a href="______constants_8h_source.html#l00006">___constants.h:6</a></div></div>
<div class="ttc" id="aspecV2_8cpp_html_a407f60e0ae1c91e8c8f71fea265b0894"><div class="ttname"><a href="specV2_8cpp.html#a407f60e0ae1c91e8c8f71fea265b0894">Y1</a></div><div class="ttdeci">double Y1(double x)</div><div class="ttdef"><b>Definition</b> <a href="specV2_8cpp_source.html#l00057">specV2.cpp:57</a></div></div>
<div class="ttc" id="aspecV2_8cpp_html_a6d045e26f999b0dfac9e4194d1a51a65"><div class="ttname"><a href="specV2_8cpp.html#a6d045e26f999b0dfac9e4194d1a51a65">J0</a></div><div class="ttdeci">double J0(double x)</div><div class="ttdef"><b>Definition</b> <a href="specV2_8cpp_source.html#l00054">specV2.cpp:54</a></div></div>
<div class="ttc" id="aspecV2_8cpp_html_ac6c1af4e90ab2100f2bea1585ce9cea4"><div class="ttname"><a href="specV2_8cpp.html#ac6c1af4e90ab2100f2bea1585ce9cea4">omega</a></div><div class="ttdeci">double omega(double p, double m)</div><div class="ttdef"><b>Definition</b> <a href="specV2_8cpp_source.html#l00049">specV2.cpp:49</a></div></div>
<div class="ttc" id="aspecV2_8cpp_html_ad6361ea05ba43c9613227a5dad0048a3"><div class="ttname"><a href="specV2_8cpp.html#ad6361ea05ba43c9613227a5dad0048a3">J1</a></div><div class="ttdeci">double J1(double x)</div><div class="ttdef"><b>Definition</b> <a href="specV2_8cpp_source.html#l00055">specV2.cpp:55</a></div></div>
<div class="ttc" id="aspecV2_8cpp_html_aef533d4e3c1ac64de647736ab0dc57b5"><div class="ttname"><a href="specV2_8cpp.html#aef533d4e3c1ac64de647736ab0dc57b5">Y0</a></div><div class="ttdeci">double Y0(double x)</div><div class="ttdef"><b>Definition</b> <a href="specV2_8cpp_source.html#l00056">specV2.cpp:56</a></div></div>
<div class="ttc" id="astructintargs_html_a2368dd52091ad0d687dfb7543210682b"><div class="ttname"><a href="structintargs.html#a2368dd52091ad0d687dfb7543210682b">intargs::Dfunc</a></div><div class="ttdeci">std::function&lt; std::complex&lt; double &gt;(double)&gt; Dfunc</div><div class="ttdef"><b>Definition</b> <a href="specV2_8cpp_source.html#l00034">specV2.cpp:34</a></div></div>
<div class="ttc" id="astructintargs_html_a31c032a36442c1d116a36f9add7a3496"><div class="ttname"><a href="structintargs.html#a31c032a36442c1d116a36f9add7a3496">intargs::pT</a></div><div class="ttdeci">double pT</div><div class="ttdef"><b>Definition</b> <a href="specV2_8cpp_source.html#l00033">specV2.cpp:33</a></div></div>
<div class="ttc" id="astructintargs_html_a5dd0c6581c940d24a7eb203d60227b4e"><div class="ttname"><a href="structintargs.html#a5dd0c6581c940d24a7eb203d60227b4e">intargs::m</a></div><div class="ttdeci">double m</div><div class="ttdef"><b>Definition</b> <a href="specV2_8cpp_source.html#l00033">specV2.cpp:33</a></div></div>
<div class="ttc" id="astructintargs_html_aaa2e3b3d6fda0ea260ad50ed52b211d3"><div class="ttname"><a href="structintargs.html#aaa2e3b3d6fda0ea260ad50ed52b211d3">intargs::fo</a></div><div class="ttdeci">freezeoutFunctions fo</div><div class="ttdef"><b>Definition</b> <a href="specV2_8cpp_source.html#l00035">specV2.cpp:35</a></div></div>
<div class="ttc" id="astructintargs_html_aaecb7be22f5935a4074513a630896685"><div class="ttname"><a href="structintargs.html#aaecb7be22f5935a4074513a630896685">intargs::func</a></div><div class="ttdeci">const std::function&lt; double(double)&gt; &amp; func</div><div class="ttdef"><b>Definition</b> <a href="integrate_8h_source.html#l00017">integrate.h:17</a></div></div>
<div class="ttc" id="astructintargs_html_aea96ae3027750fab9318a81dcc771a85"><div class="ttname"><a href="structintargs.html#aea96ae3027750fab9318a81dcc771a85">intargs::anti</a></div><div class="ttdeci">bool anti</div><div class="ttdef"><b>Definition</b> <a href="specV2_8cpp_source.html#l00036">specV2.cpp:36</a></div></div>
</div><!-- fragment --><p>GSL_FUNCTION (NEEDED BY GSL INTEGRATORS) CANNOT BE INITIALIZED WITH STD::FUNCTION OBJECTS, FUNCTION POINTERS SEEM TO WORK, SO WE USE THOSE FUNCTION POINTERS (*integrand) </p>

<p class="definition">Definition at line <a class="el" href="specV2_8cpp_source.html#l00057">57</a> of file <a class="el" href="specV2_8cpp_source.html">specV2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   61</span>                                                                                  {</div>
<div class="line"><span class="lineno">   62</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">   63</span><span class="comment">        returns the full integrand at given alpha with the factor of 2*pi^2</span></div>
<div class="line"><span class="lineno">   64</span><span class="comment">    */</span></div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">   67</span><span class="comment">    THE FOLLOWING WORKS, BUT IS SLOW BECAUSE THE POINTER IS DEREFERENCED (*) AND A COPY OF THE UNDERLYING</span></div>
<div class="line"><span class="lineno">   68</span><span class="comment">    PARAMETER OBJECT - CONTAINING THE INTERPOLATING FUNCTION FROM THE FREEZEOUT SURFACE - IS </span></div>
<div class="line"><span class="lineno">   69</span><span class="comment">    CREATED AT EVERY FUNCTION CALL. ITS BETTER TO KEEP ONLY THE POINTER.</span></div>
<div class="line"><span class="lineno">   70</span><span class="comment"></span> </div>
<div class="line"><span class="lineno">   71</span><span class="comment">    WE KEEP THE CODE IN THE COMMENT JUST IN CASE WE NOTICE PROBLEMS WITH THE POINTER USAGE.</span></div>
<div class="line"><span class="lineno">   72</span><span class="comment">    */</span> </div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   94</span>    <a class="code hl_struct" href="structintargs.html">intargs</a>* args = (<span class="keyword">struct </span><a class="code hl_struct" href="structintargs.html">intargs</a> *)params;</div>
<div class="line"><span class="lineno">   95</span>    <span class="keywordtype">double</span>  <a class="code hl_variable" href="structintargs.html#a5dd0c6581c940d24a7eb203d60227b4e">m</a>(args-&gt;<a class="code hl_variable" href="structintargs.html#a5dd0c6581c940d24a7eb203d60227b4e">m</a>),</div>
<div class="line"><span class="lineno">   96</span>            <a class="code hl_variable" href="structintargs.html#a31c032a36442c1d116a36f9add7a3496">pT</a>(args-&gt;<a class="code hl_variable" href="structintargs.html#a31c032a36442c1d116a36f9add7a3496">pT</a>),</div>
<div class="line"><span class="lineno">   97</span>            wT(<a class="code hl_function" href="specV2_8cpp.html#ac6c1af4e90ab2100f2bea1585ce9cea4">omega</a>(<a class="code hl_variable" href="structintargs.html#a31c032a36442c1d116a36f9add7a3496">pT</a>,<a class="code hl_variable" href="structintargs.html#a5dd0c6581c940d24a7eb203d60227b4e">m</a>)),</div>
<div class="line"><span class="lineno">   98</span>            r(args-&gt;<a class="code hl_variable" href="structintargs.html#aaa2e3b3d6fda0ea260ad50ed52b211d3">fo</a>.<a class="code hl_variable" href="structfreezeoutFunctions.html#a180e1ed9fb6c6e7bef81db72a73caefa">r</a>(alpha)       * <a class="code hl_variable" href="______constants_8h.html#a973b252ed356de5f20e5f775d9ec8934">fmtoIGeV</a>),</div>
<div class="line"><span class="lineno">   99</span>            Dr(args-&gt;<a class="code hl_variable" href="structintargs.html#aaa2e3b3d6fda0ea260ad50ed52b211d3">fo</a>.<a class="code hl_variable" href="structfreezeoutFunctions.html#a4e2f2e564792d110beec73fa6ac39580">Dr</a>(alpha)     * <a class="code hl_variable" href="______constants_8h.html#a973b252ed356de5f20e5f775d9ec8934">fmtoIGeV</a>),</div>
<div class="line"><span class="lineno">  100</span>            tau(args-&gt;<a class="code hl_variable" href="structintargs.html#aaa2e3b3d6fda0ea260ad50ed52b211d3">fo</a>.<a class="code hl_variable" href="structfreezeoutFunctions.html#a32c184e841ff5b7fe2b2f1b3a46a3f87">tau</a>(alpha)   * <a class="code hl_variable" href="______constants_8h.html#a973b252ed356de5f20e5f775d9ec8934">fmtoIGeV</a>),</div>
<div class="line"><span class="lineno">  101</span>            Dtau(args-&gt;<a class="code hl_variable" href="structintargs.html#aaa2e3b3d6fda0ea260ad50ed52b211d3">fo</a>.<a class="code hl_variable" href="structfreezeoutFunctions.html#a668240e0c9454b18953319d7938de8d8">Dtau</a>(alpha) * <a class="code hl_variable" href="______constants_8h.html#a973b252ed356de5f20e5f775d9ec8934">fmtoIGeV</a>);</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>    <span class="keywordtype">double</span> pm = (args-&gt;<a class="code hl_variable" href="structintargs.html#aea96ae3027750fab9318a81dcc771a85">anti</a> ? -1.0 : +1.0);</div>
<div class="line"><span class="lineno">  104</span>    <span class="keywordflow">return</span> 2 * M_PI * M_PI * r * tau * (</div>
<div class="line"><span class="lineno">  105</span>        args-&gt;<a class="code hl_variable" href="structintargs.html#a2368dd52091ad0d687dfb7543210682b">Dfunc</a>(alpha) * (</div>
<div class="line"><span class="lineno">  106</span>                        <a class="code hl_function" href="specV2_8cpp.html#a6d045e26f999b0dfac9e4194d1a51a65">J0</a>(r*<a class="code hl_variable" href="structintargs.html#a31c032a36442c1d116a36f9add7a3496">pT</a>) * ( -<a class="code hl_function" href="specV2_8cpp.html#aef533d4e3c1ac64de647736ab0dc57b5">Y0</a>(tau*wT) + pm * 1i * <a class="code hl_function" href="specV2_8cpp.html#a6d045e26f999b0dfac9e4194d1a51a65">J0</a>(tau*wT))</div>
<div class="line"><span class="lineno">  107</span>        ) +</div>
<div class="line"><span class="lineno">  108</span>        args-&gt;<a class="code hl_variable" href="structintargs.html#aaecb7be22f5935a4074513a630896685">func</a>(alpha) * (</div>
<div class="line"><span class="lineno">  109</span>            Dtau*<a class="code hl_variable" href="structintargs.html#a31c032a36442c1d116a36f9add7a3496">pT</a> *   <a class="code hl_function" href="specV2_8cpp.html#ad6361ea05ba43c9613227a5dad0048a3">J1</a>(r*<a class="code hl_variable" href="structintargs.html#a31c032a36442c1d116a36f9add7a3496">pT</a>) * ( -<a class="code hl_function" href="specV2_8cpp.html#aef533d4e3c1ac64de647736ab0dc57b5">Y0</a>(tau*wT) + pm * 1i * <a class="code hl_function" href="specV2_8cpp.html#a6d045e26f999b0dfac9e4194d1a51a65">J0</a>(tau*wT)) +</div>
<div class="line"><span class="lineno">  110</span>            Dr*wT *     <a class="code hl_function" href="specV2_8cpp.html#a6d045e26f999b0dfac9e4194d1a51a65">J0</a>(r*<a class="code hl_variable" href="structintargs.html#a31c032a36442c1d116a36f9add7a3496">pT</a>) * ( -<a class="code hl_function" href="specV2_8cpp.html#a407f60e0ae1c91e8c8f71fea265b0894">Y1</a>(tau*wT) + pm * 1i * <a class="code hl_function" href="specV2_8cpp.html#ad6361ea05ba43c9613227a5dad0048a3">J1</a>(tau*wT))</div>
<div class="line"><span class="lineno">  111</span>        )</div>
<div class="line"><span class="lineno">  112</span>    );</div>
<div class="line"><span class="lineno">  113</span>};</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
